<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ShapeShift.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Cent2</a> &gt; <a href="index.source.html" class="el_package">bomb.modules.s</a> &gt; <span class="el_source">ShapeShift.java</span></div><h1>ShapeShift.java</h1><pre class="source lang-java linenums">package bomb.modules.s;

import bomb.Widget;
import bomb.enumerations.Indicators;
import bomb.enumerations.Ports;
import bomb.enumerations.ShiftShape;
import bomb.tools.data.structures.graph.list.ListGraph;

import java.util.AbstractMap;
import java.util.ArrayList;

<span class="nc" id="L12">public class ShapeShift extends Widget {</span>
<span class="fc" id="L13">    private static boolean serialCodeCheck = false;</span>
<span class="fc" id="L14">    private static final int[][] countTracker = new int[4][4];</span>
    private static ListGraph&lt;AbstractMap.SimpleEntry&lt;ShiftShape, ShiftShape&gt;&gt; graph;

    static {
<span class="fc" id="L18">        zeroOutArray();</span>
<span class="fc" id="L19">        initializeGraph();</span>
<span class="fc" id="L20">    }</span>

    public static ShiftShape[] solve(ShiftShape left, ShiftShape right){
<span class="fc" id="L23">        serialCodeChecker();</span>
<span class="fc" id="L24">        increment(left, right);</span>
<span class="fc bfc" id="L25" title="All 2 branches covered.">        if (checkIfVisitedTwice(left, right)) {</span>
<span class="fc" id="L26">            AbstractMap.SimpleEntry&lt;ShiftShape, ShiftShape&gt; pair = graph.get(</span>
                    new AbstractMap.SimpleEntry&lt;&gt;(left, right))
<span class="fc" id="L28">                    .get(booleanIntConversion(conditionMap(left, right)));</span>
<span class="fc" id="L29">            return solve(pair.getKey(), pair.getValue());</span>
        }
<span class="fc" id="L31">        resetMod();</span>
<span class="fc" id="L32">        return new ShiftShape[]{left, right};</span>
    }

    private static void serialCodeChecker() throws IllegalArgumentException{
<span class="fc bfc" id="L36" title="All 2 branches covered.">        if (!serialCodeCheck) {</span>
<span class="fc bfc" id="L37" title="All 2 branches covered.">            if (serialCode.isEmpty()) throw new IllegalArgumentException(&quot;Serial Code is empty&quot;);</span>
<span class="fc" id="L38">            serialCodeCheck = true;</span>
        }
<span class="fc" id="L40">    }</span>

    private static void resetMod(){
<span class="fc" id="L43">        serialCodeCheck = false;</span>
<span class="fc" id="L44">        zeroOutArray();</span>
<span class="fc" id="L45">    }</span>

    private static void zeroOutArray(){
<span class="fc bfc" id="L48" title="All 2 branches covered.">        for (ShiftShape leftSide : ShiftShape.values()){</span>
<span class="fc bfc" id="L49" title="All 2 branches covered.">            for (ShiftShape rightSide : ShiftShape.values())</span>
<span class="fc" id="L50">                countTracker[leftSide.getIdx()][rightSide.getIdx()] = 0;</span>
        }
<span class="fc" id="L52">    }</span>

    private static void initializeGraph(){
<span class="fc" id="L55">        graph = new ListGraph&lt;&gt;(false);</span>
<span class="fc" id="L56">        initializeTriples();</span>
<span class="fc" id="L57">    }</span>

    private static ArrayList&lt;AbstractMap.SimpleEntry&lt;ShiftShape, ShiftShape&gt;&gt; createList(){
<span class="fc" id="L60">        ArrayList&lt;AbstractMap.SimpleEntry&lt;ShiftShape, ShiftShape&gt;&gt; list = new ArrayList&lt;&gt;();</span>
<span class="fc bfc" id="L61" title="All 2 branches covered.">        for (ShiftShape left : ShiftShape.values()){</span>
<span class="fc bfc" id="L62" title="All 2 branches covered.">            for (ShiftShape right : ShiftShape.values())</span>
<span class="fc" id="L63">                list.add(new AbstractMap.SimpleEntry&lt;&gt;(left, right));</span>
        }
<span class="fc" id="L65">        return list;</span>
    }

    private static void initializeTriples(){
<span class="fc" id="L69">        ArrayList&lt;AbstractMap.SimpleEntry&lt;ShiftShape, ShiftShape&gt;&gt; list = createList();</span>
<span class="fc" id="L70">        initializePairs(list.get(0), list.get(8), list.get(15));</span>
<span class="fc" id="L71">        initializePairs(list.get(1), list.get(10), list.get(15));</span>
<span class="fc" id="L72">        initializePairs(list.get(2), list.get(3), list.get(0));</span>
<span class="fc" id="L73">        initializePairs(list.get(3), list.get(11), list.get(14));</span>
<span class="fc" id="L74">        initializePairs(list.get(4), list.get(2), list.get(9));</span>
<span class="fc" id="L75">        initializePairs(list.get(5), list.get(10), list.get(7));</span>
<span class="fc" id="L76">        initializePairs(list.get(6), list.get(3), list.get(12));</span>
<span class="fc" id="L77">        initializePairs(list.get(7), list.get(0), list.get(1));</span>
<span class="fc" id="L78">        initializePairs(list.get(8), list.get(13), list.get(1));</span>
<span class="fc" id="L79">        initializePairs(list.get(9), list.get(6), list.get(13));</span>
<span class="fc" id="L80">        initializePairs(list.get(10), list.get(4), list.get(6));</span>
<span class="fc" id="L81">        initializePairs(list.get(11), list.get(5), list.get(12));</span>
<span class="fc" id="L82">        initializePairs(list.get(12), list.get(2), list.get(9));</span>
<span class="fc" id="L83">        initializePairs(list.get(13), list.get(4), list.get(7));</span>
<span class="fc" id="L84">        initializePairs(list.get(14), list.get(5), list.get(8));</span>
<span class="fc" id="L85">        initializePairs(list.get(15), list.get(11), list.get(14));</span>
<span class="fc" id="L86">    }</span>

    @SafeVarargs
    private static void initializePairs(AbstractMap.SimpleEntry&lt;ShiftShape, ShiftShape&gt;... trios){
<span class="fc" id="L90">        graph.addEdge(trios[0], trios[1]);</span>
<span class="fc" id="L91">        graph.addEdge(trios[0], trios[2]);</span>
<span class="fc" id="L92">    }</span>

    private static void increment(ShiftShape left, ShiftShape right){
<span class="fc" id="L95">        countTracker[left.getIdx()][right.getIdx()] += 1;</span>
<span class="fc" id="L96">    }</span>

    private static boolean checkIfVisitedTwice(ShiftShape left, ShiftShape right){
<span class="fc bfc" id="L99" title="All 2 branches covered.">        return countTracker[left.getIdx()][right.getIdx()] &lt; 2;</span>
    }

    private static boolean conditionMap(ShiftShape left, ShiftShape right){
<span class="fc bfc" id="L103" title="All 4 branches covered.">        switch (left){</span>
            case ROUND:
<span class="fc" id="L105">                return roundedOptions(right);</span>
            case FLAT:
<span class="fc" id="L107">                return rectangularOptions(right);</span>
            case POINT:
<span class="fc" id="L109">                return triangularOptions(right);</span>
            default:
<span class="fc" id="L111">                return ticketOptions(right);</span>
        }
    }

    private static boolean roundedOptions(ShiftShape right){
<span class="fc bfc" id="L116" title="All 4 branches covered.">        switch (right){</span>
            case ROUND:
<span class="fc" id="L118">                return hasVowel();</span>
            case FLAT:
<span class="fc" id="L120">                return hasLitIndicator(Indicators.SND);</span>
            case POINT:
<span class="fc" id="L122">                return hasLitIndicator(Indicators.SIG);</span>
            default:
<span class="fc bfc" id="L124" title="All 2 branches covered.">                return numDoubleAs &gt; 1;</span>
        }
    }

    private static boolean rectangularOptions(ShiftShape right){
<span class="pc bpc" id="L129" title="1 of 4 branches missed.">        switch (right){</span>
            case ROUND:
<span class="fc" id="L131">                return hasMoreThan(Ports.DVI, 0);</span>
            case FLAT:
<span class="fc bfc" id="L133" title="All 2 branches covered.">                return lastDigit() % 2 == 1;</span>
            case POINT:
<span class="nc" id="L135">                return hasLitIndicator(Indicators.MSA);</span>
            default:
<span class="fc" id="L137">                return hasUnlitIndicator(Indicators.BOB);</span>
        }
    }

    private static boolean triangularOptions(ShiftShape right){
<span class="fc bfc" id="L142" title="All 4 branches covered.">        switch (right){</span>
            case ROUND:
<span class="fc" id="L144">                return hasMoreThan(Ports.PARALLEL, 0);</span>
            case FLAT:
<span class="fc" id="L146">                return hasUnlitIndicator(Indicators.CAR);</span>
            case POINT:
<span class="fc" id="L148">                return hasLitIndicator(Indicators.IND);</span>
            default:
<span class="fc" id="L150">                return hasMoreThan(Ports.RJ45, 0);</span>
        }
    }

    private static boolean ticketOptions(ShiftShape right){
<span class="pc bpc" id="L155" title="1 of 4 branches missed.">        switch (right){</span>
            case ROUND:
<span class="nc" id="L157">                return hasMoreThan(Ports.RCA, 0);</span>
            case FLAT:
<span class="fc" id="L159">                return hasUnlitIndicator(Indicators.FRQ);</span>
            case POINT:
<span class="fc" id="L161">                return hasMoreThan(Ports.PS2, 0);</span>
            default:
<span class="fc bfc" id="L163" title="All 2 branches covered.">                return getAllBatteries() &gt;= 3;</span>
        }
    }

    private static int booleanIntConversion(boolean bool){
<span class="fc bfc" id="L168" title="All 2 branches covered.">        return bool ? 1 : 0;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>